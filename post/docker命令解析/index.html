<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Docker命令解析 - Record the life</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="muxin" />
  <meta name="description" content="" />







<meta name="generator" content="Hugo 0.55.6" />


<link rel="canonical" href="http://mu-xin.github.io/post/docker%E5%91%BD%E4%BB%A4%E8%A7%A3%E6%9E%90/" />



<link rel="icon" href="/fluidicon.png" />











<link rel="stylesheet" href="/sass/jane.min.98eb6e9b65e7db1489f57e9917a82404ffa5fa0c13df6e4993091387d8628dbf.css" integrity="sha256-mOtum2Xn2xSJ9X6ZF6gkBP&#43;l&#43;gwT325JkwkTh9hijb8=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="Docker命令解析" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://mu-xin.github.io/post/docker%E5%91%BD%E4%BB%A4%E8%A7%A3%E6%9E%90/" />
<meta property="article:published_time" content="2020-04-01T16:52:50&#43;08:00"/>
<meta property="article:modified_time" content="2020-04-01T16:52:50&#43;08:00"/>

<meta itemprop="name" content="Docker命令解析">
<meta itemprop="description" content="">


<meta itemprop="datePublished" content="2020-04-01T16:52:50&#43;08:00" />
<meta itemprop="dateModified" content="2020-04-01T16:52:50&#43;08:00" />
<meta itemprop="wordCount" content="754">



<meta itemprop="keywords" content="Docker," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker命令解析"/>
<meta name="twitter:description" content=""/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Record the life</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/about/">关于我</a>
          
        
      </li>
    
  </ul>
</nav>


  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Record the life
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://mu-xin.github.io/about/">关于我</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Docker命令解析</h1>
      
      <div class="post-meta">
        <time datetime="2020-04-01" class="post-time">
          2020-04-01
        </time>
        <div class="post-category">
            <a href="http://mu-xin.github.io/categories/docker/"> Docker </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    

    
    <div class="post-content">
      <p><img src="/business-1845350_1280.jpg" alt="docker command" /></p>

<h2 id="前因">前因</h2>

<p><strong>近期在玩docker,但是迫于电脑硬盘只有256大小,拉取的镜像太多以及生成的容器没有及时的清理,定睛一看磁盘空间基本快接近枯竭了.没办法,只能去进行手动清理了.清理的过程中发现Docker中的命令其实挺有意思的.那么就简单的记录一下吧!</strong></p>

<h3 id="image">IMAGE</h3>

<p><code>docker images</code></p>

<pre>REPOSITORY                                  TAG                 IMAGE ID            CREATED             SIZE
nginx-keepalived-docker-demo_nginx_master   latest              3a59ab4cf4e9        22 hours ago        35MB
nginx-keepalived-docker-demo_nginx_slave    latest              3a59ab4cf4e9        22 hours ago        35MB
nginx                                       1.16.1              588bb5d559c2        2 days ago          127MB
haproxy                                     1.7-alpine          67836177b9f7        8 days ago          7.75MB
mongo                                       4.2.3               97a9a3e85158        12 days ago         386MB
debian                                      stable              e1aa81b5fcf3        5 weeks ago         114MB
mongo                                       latest              bcef5fd2979d        5 weeks ago         386MB
mysql                                       latest              afaec1334369        5 weeks ago         471MB
redis                                       latest              44d36d2c2374        2 months ago        98.2MB
confluentinc/cp-kafka                       5.4.0               7fa4a6c57613        2 months ago        598MB
centos                                      centos7             5e35e350aded        4 months ago        203MB
nginx                                       1.13.5-alpine       ea7bef82810a        2 years ago         15.5MB
php                                         7.1.6-fpm           67514026b84e        2 years ago         382MB
zookeeper                                   3.4.9               3b83d9104a4c        3 years ago         129MB<pre>



<pre>
docker images --help

Usage:  docker images [OPTIONS] [REPOSITORY[:TAG]]

List images

Options:
  -a, --all             Show all images (default hides intermediate images)列出所有镜像
      --digests         Show digests 现实摘要
  -f, --filter filter   Filter output based on conditions provided 过滤器
      --format string   Pretty-print images using a Go template 输出格式
      --no-trunc        Don't truncate output 完整的输出全部内容
  -q, --quiet           Only show numeric IDs 只输出镜像ID


--format "table {{.ID}}:\t {{.REPOSITYR}}"

.ID Image ID 镜像id
.Repository Image repository 包名
.Tag    Image tag 标签
.Digest Image digest 摘要
.CreatedSince   Elapsed time since the image was created 创建以前
.CreatedAt  Time when the image was created 创建以后
.Size   Image disk size 大小



--filter dangling=true

dangling (boolean - true or false)
label (label=&ltkey&gt or label=&ltkey&gt=&ltvalue&gt)
before (&ltimage-name&gt[:&lttag&gt], &ltimage id&gt or &ltimage@digest&gt) - filter images created before given id or references
since (&ltimage-name&gt[:&lttag&gt], &ltimage id&gt or &ltimage@digest&gt) - filter images created since given id or references
reference (pattern of an image reference) - filter images whose reference matches the specified pattern 
<pre>


#### **查找所有nginx的镜像,并只显示该镜像的ID**

`docker images --filter=reference='nginx*:*'`

&gt 匹配REPOSITORY名称,如果含有多个reference的话它们的匹配关系为逻辑或 or 进行匹配

<pre>3a59ab4cf4e9
3a59ab4cf4e9
588bb5d559c2
ea7bef82810a
<pre>

#### **删除所有mongo的镜像**


`docker rmi $(docker images --filter=reference='mongo' -q)`

&gt 首先先找出所有mongo的镜像id,然后使用rmi命令直接进行删除

<pre>
97a9a3e85158
bcef5fd2979d
<pre>


#### **删除所有虚浮**(none)镜像

`docker rmi $(docker images -f "dangling=true" -q)`

&gt 官方文档其实已经介绍很清楚了,意思就是先查出所有none的镜像id 然后进行删除,大致思路都一样,万变不离其宗



##  CONTAINER

`docker ps | docker container ps | docker-compose ps`


<pre>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES
e9576e512798        mongo:4.2.3         "docker-entrypoint.s…"   10 days ago         Up 5 days           0.0.0.0:27017-&gt27017/tcp            local_mongo
2ad6ad6f5560        mysql:latest        "docker-entrypoint.s…"   5 weeks ago         Up 5 days           0.0.0.0:3306-&gt3306/tcp, 33060/tcp   local_mysql
2020efb812a1        redis:latest        "docker-entrypoint.s…"   5 weeks ago         Up 5 days           0.0.0.0:6379-&gt6379/tcp              local_redis<pre>


<pre>
docker ps --help

Usage:  docker ps [OPTIONS]

List containers

Options:
  -a, --all             Show all containers (default shows just running)
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print containers using a Go template
  -n, --last int        Show n last created containers (includes all states) (default -1)
  -l, --latest          Show the latest created container (includes all states)
      --no-trunc        Don't truncate output
  -q, --quiet           Only display numeric IDs
  -s, --size            Display total file sizes
<pre>

**原理其实和image命令差不多,但是其中的一些查询key略有变动,例如:**
##### *--filter 参数*
<pre>
id  Container’s ID
name    Container’s name
label   An arbitrary string representing either a key or a key-value pair. Expressed as &ltkey&gt or &ltkey&gt=&ltvalue&gt
exited  An integer representing the container’s exit code. Only useful with --all.
status  One of created, restarting, running, removing, paused, exited, or dead
ancestor    Filters containers which share a given image as an ancestor. Expressed as &ltimage-name&gt[:&lttag&gt], &ltimage id&gt, or &ltimage@digest&gt
before or since Filters containers created before or after a given container ID or name
volume  Filters running containers which have mounted a given volume or bind mount.
network Filters running containers connected to a given network.
publish or expose   Filters containers which publish or expose a given port. Expressed as &ltport&gt[/&ltproto&gt] or &ltstartport-endport&gt/[&ltproto&gt]
health  Filters containers based on their healthcheck status. One of starting, healthy, unhealthy or none.
isolation   Windows daemon only. One of default, process, or hyperv.
is-task Filters containers that are a “task” for a service. Boolean option (true or false)
</pre>

<p>``
docker ps &ndash;filter status=exited 查询所有停止运行的容器</p>

<p>//如果需要释放一批停止的容器的话可以执行以下命令</p>

<p>docker rm $(docker ps &ndash;filter status=exited -q)</p>

<p>可以根据容器名称进行查询</p>

<p>docker ps &ndash;filter name=redis// 多个name查询时查询力度为逻辑或 (or)的关系不同key之间查询力度为逻辑与(and)的关系</p>

<p>``</p>

<p>&amp;gt 条件虽多，但万变不离其宗，只要再记住以下 3 条准则：</p>

<ol>
<li>选项后跟的都是键值对,如果有多个过滤条件，就多次使用 filter 选项。</li>
<li>相同条件之间的关系是或，不同条件之间的关系是与。</li>
<li>id 和 name，支持正则表达式，使用起来非常灵活。</li>
</ol>

<h5 id="format-参数"><em>&ndash;format 参数</em></h5>

<p><pre>
.ID Container ID
.Image  Image ID
.Command    Quoted command
.CreatedAt  Time when the container was created.
.RunningFor Elapsed time since the container was started.
.Ports  Exposed ports.
.Status Container status.
.Size   Container disk size.
.Names  Container names.
.Labels All labels assigned to the container.
.Label  Value of a specific label for this container. For example &lsquo;{{.Label &ldquo;com.docker.swarm.cpu&rdquo;}}&rsquo;
.Mounts Names of the volumes mounted in this container.
.Networks   Names of the networks attached to this container.
<pre></p>

<p><em>如果在使用docker ps进行查看容器的时候系统会默认输出以下类目的数据,而我们有可能只关心端口的占用,亦或者状态值,这个时候就需要使用格式化输出参数了</em></p>

<p>&amp;gt CONTAINER ID  | IMAGE     |  COMMAND   | CREATED        |    STATUS    |          PORTS           |         NAMES</p>

<p><code>docker ps --format &quot;{{.ID}}: {{.Status}}&quot;</code></p>

<p><pre>
e9576e512798: Up 5 days
2ad6ad6f5560: Up 5 days
2020efb812a1: Up 5 days
<pre></p>

<p><em>如果想带上表格列头，需要再 template 中加上 table 指令：</em></p>

<p><code>docker ps --format &quot;table {{.ID}}:\t {{.Image}}&quot;</code></p>

<p><pre>
CONTAINER ID:        IMAGE
e9576e512798:        mongo:4.2.3
2ad6ad6f5560:        mysql:latest
2020efb812a1:        redis:latest
<pre></p>
    </div>

    
    

  
  



    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://mu-xin.github.io/tags/docker/">Docker</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/%E6%AF%8F%E5%A4%A9%E4%B8%80%E4%B8%AAlinux%E5%91%BD%E4%BB%A4-tree/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">每天一个Linux命令 Tree</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/2020%E5%B9%B43%E6%9C%8825%E6%97%A5%E5%AD%90%E6%97%B6%E9%9A%8F%E6%83%B3/">
            <span class="next-text nav-default">2020年3月25日子时随想</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:jun771480011@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/mu-xin" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="http://mu-xin.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  

  <span class="copyright-year">
    &copy;
    
      2017 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        muxin
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>


















</body>
</html>
